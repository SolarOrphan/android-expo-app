{"ast":null,"code":"import _slicedToArray from\"@babel/runtime/helpers/slicedToArray\";import _regeneratorRuntime from\"@babel/runtime/regenerator\";import{StatusBar}from\"expo-status-bar\";import StyleSheet from\"react-native-web/dist/exports/StyleSheet\";import Text from\"react-native-web/dist/exports/Text\";import View from\"react-native-web/dist/exports/View\";import TextInput from\"react-native-web/dist/exports/TextInput\";import TouchableOpacity from\"react-native-web/dist/exports/TouchableOpacity\";import Image from\"react-native-web/dist/exports/Image\";import Alert from\"react-native-web/dist/exports/Alert\";import{React,useEffect,useState}from\"react\";import AsyncStorage from\"@react-native-async-storage/async-storage\";import Loading from\"../components/Loading\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var logo=require(\"../assets/img/logo.png\");export default function Login(_ref){var navigation=_ref.navigation;var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),username=_useState2[0],username_chg=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),password=_useState4[0],password_chg=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),load=_useState6[0],load_chg=_useState6[1];var twoOptionAlertHandler=function twoOptionAlertHandler(){Alert.alert(\"Please try again\",\"You've entered the incorrect login details\",[{text:\"Yes\",onPress:function onPress(){return console.log(\"Yes Pressed\");}},{text:\"No\",onPress:function onPress(){return console.log(\"No Pressed\");},style:\"cancel\"}],{cancelable:false});};var login_submit=function _callee2(username,password){return _regeneratorRuntime.async(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:load_chg(true);_context2.next=3;return _regeneratorRuntime.awrap(fetch(\"http://192.168.0.158:3000/user/login\",{method:\"POST\",headers:{Accept:\"application/json\",\"Content-Type\":\"application/json\"},body:JSON.stringify({username:username,password:password})}).then(function _callee(response){var res;return _regeneratorRuntime.async(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return _regeneratorRuntime.awrap(response.json());case 2:res=_context.sent;console.log(res);if(!(res.message==\"Success\")){_context.next=18;break;}_context.prev=5;_context.next=8;return _regeneratorRuntime.awrap(AsyncStorage.setItem(\"@user_id\",res.data.id));case 8:username_chg(\"\");password_chg(\"\");navigation.navigate(\"Dashboard\");load_chg(false);_context.next=16;break;case 14:_context.prev=14;_context.t0=_context[\"catch\"](5);case 16:_context.next=19;break;case 18:if(res.message==\"Fail\"){load_chg(false);console.log(\"Fail\");}case 19:twoOptionAlertHandler();case 20:case\"end\":return _context.stop();}}},null,null,[[5,14]],Promise);}).catch(function(error){console.error(error);}));case 3:case\"end\":return _context2.stop();}}},null,null,null,Promise);};var storage_userid=function _callee3(){return _regeneratorRuntime.async(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return _regeneratorRuntime.awrap(AsyncStorage.getItem(\"@user_id\"));case 3:return _context3.abrupt(\"return\",_context3.sent);case 6:_context3.prev=6;_context3.t0=_context3[\"catch\"](0);console.log(_context3.t0);return _context3.abrupt(\"return\",null);case 10:case\"end\":return _context3.stop();}}},null,null,[[0,6]],Promise);};useEffect(function(){storage_userid().then(function(user_id){if(user_id!=null)navigation.reset({index:0,routes:[{name:\"Dashboard\"}]});});},[]);return _jsxs(View,{style:styles.container,children:[load==true?_jsx(Loading,{}):null,_jsx(View,{style:styles.top_section,children:_jsx(Image,{source:logo,style:styles.logo})}),_jsxs(View,{style:styles.bottom_section,children:[_jsx(Text,{style:styles.header,children:\"LOGIN\"}),_jsx(Text,{style:styles.msg,children:\"Please enter your login detail down below.\"}),_jsx(TextInput,{style:styles.text_box,placeholder:\"Username\",defaultValue:username,onChangeText:function onChangeText(new_username){return username_chg(new_username);}}),_jsx(TextInput,{style:styles.text_box,placeholder:\"Passowrd\",defaultValue:password,onChangeText:function onChangeText(new_password){return password_chg(new_password);},secureTextEntry:true}),_jsx(TouchableOpacity,{style:styles.Sign_in_btn,onPress:function onPress(){return login_submit(username,password);},children:_jsx(Text,{style:styles.btn_label,children:\"LOGIN\"})}),_jsx(TouchableOpacity,{style:styles.Sign_in_btn,onPress:function onPress(){return navigation.navigate(\"CreateAccount\");},children:_jsx(Text,{style:styles.btn_label,children:\"CREATE ACCOUNT\"})}),_jsx(TouchableOpacity,{style:styles.forgot_btn,children:_jsx(Text,{style:styles.forgot_btn_label,children:\"Forgot Passowrd\"})})]}),_jsx(StatusBar,{style:\"auto\"})]});}var styles=StyleSheet.create({container:{flex:1,backgroundColor:\"#11b8f5\",justifyContent:\"center\",padding:20,display:\"flex\"},top_section:{},bottom_section:{backgroundColor:\"#fff\",marginTop:20,padding:10,borderRadius:10},logo:{marginLeft:\"auto\",marginRight:\"auto\",borderRadius:50},header:{textAlign:\"center\",fontSize:25,fontWeight:\"bold\"},msg:{textAlign:\"center\",fontSize:17},text_box:{backgroundColor:\"#a7a7a7\",color:\"#000\",borderRadius:10,height:45,padding:10,margin:10,fontSize:16},Sign_in_btn:{backgroundColor:\"#f00\",height:50,width:180,margin:3,marginLeft:\"auto\",marginRight:\"auto\",borderRadius:15,display:\"flex\",justifyContent:\"center\",alignItems:\"center\"},btn_label:{fontWeight:\"bold\",fontSize:15,color:\"#fff\"},forgot_btn_label:{fontWeight:\"100\",fontSize:15,color:\"#59d3ff\",textAlign:\"center\"}});","map":{"version":3,"names":["StatusBar","React","useEffect","useState","AsyncStorage","Loading","logo","require","Login","navigation","username","username_chg","password","password_chg","load","load_chg","twoOptionAlertHandler","Alert","alert","text","onPress","console","log","style","cancelable","login_submit","fetch","method","headers","Accept","body","JSON","stringify","then","response","json","res","message","setItem","data","id","navigate","catch","error","storage_userid","getItem","user_id","reset","index","routes","name","styles","container","top_section","bottom_section","header","msg","text_box","new_username","new_password","Sign_in_btn","btn_label","forgot_btn","forgot_btn_label","StyleSheet","create","flex","backgroundColor","justifyContent","padding","display","marginTop","borderRadius","marginLeft","marginRight","textAlign","fontSize","fontWeight","color","height","margin","width","alignItems"],"sources":["/home/panda/Desktop/Clients/Jaja or Junior/android-expo-app/client/screens/Login.js"],"sourcesContent":["import { StatusBar } from \"expo-status-bar\";\nimport {\n  StyleSheet,\n  Text,\n  View,\n  TextInput,\n  TouchableOpacity,\n  Image,\n  Alert,\n} from \"react-native\";\nimport { React, useEffect, useState } from \"react\";\nimport AsyncStorage from \"@react-native-async-storage/async-storage\";\nimport Loading from \"../components/Loading\";\n\nconst logo = require(\"../assets/img/logo.png\");\nexport default function Login({ navigation }) {\n  const [username, username_chg] = useState(\"\");\n  const [password, password_chg] = useState(\"\");\n  const [load, load_chg] = useState(false);\n  const twoOptionAlertHandler = () => {\n    //function to make two option alert\n    Alert.alert(\n      //title\n      \"Please try again\",\n      //body\n      \"You've entered the incorrect login details\",\n      [\n        {\n          text: \"Yes\",\n          onPress: () => console.log(\"Yes Pressed\"),\n        },\n        {\n          text: \"No\",\n          onPress: () => console.log(\"No Pressed\"),\n          style: \"cancel\",\n        },\n      ],\n      { cancelable: false }\n      //clicking out side of alert will not cancel\n    );\n  };\n  const login_submit = async (username, password) => {\n    load_chg(true);\n    await fetch(\"http://192.168.0.158:3000/user/login\", {\n      method: \"POST\",\n      headers: {\n        Accept: \"application/json\",\n        \"Content-Type\": \"application/json\",\n      },\n      body: JSON.stringify({\n        username: username,\n        password: password,\n      }),\n    })\n      .then(async (response) => {\n        let res = await response.json();\n        console.log(res)\n        if (res.message == \"Success\") {\n          try {\n            await AsyncStorage.setItem(\"@user_id\", res.data.id);\n            username_chg(\"\");\n            password_chg(\"\");\n            navigation.navigate(\"Dashboard\");\n            load_chg(false);\n          } catch (e) {\n            // saving error\n          }\n        } else if (res.message == \"Fail\") {\n          load_chg(false);\n          console.log(\"Fail\");\n        }\n        twoOptionAlertHandler();\n      })\n      .catch((error) => {\n        console.error(error);\n      });\n  };\n\n  const storage_userid = async () => {\n    try {\n      return await AsyncStorage.getItem(\"@user_id\");\n    } catch (e) {\n      console.log(e);\n      return null;\n    }\n  };\n  useEffect(() => {\n    storage_userid().then((user_id) => {\n      if (user_id != null)\n        navigation.reset({\n          index: 0,\n          routes: [{ name: \"Dashboard\" }],\n        });\n    });\n  }, []);\n  return (\n    <View style={styles.container}>\n      {load == true ? <Loading /> : null}\n      <View style={styles.top_section}>\n        <Image source={logo} style={styles.logo} />\n      </View>\n      <View style={styles.bottom_section}>\n        <Text style={styles.header}>LOGIN</Text>\n        <Text style={styles.msg}>\n          Please enter your login detail down below.\n        </Text>\n        <TextInput\n          style={styles.text_box}\n          placeholder=\"Username\"\n          defaultValue={username}\n          onChangeText={(new_username) => username_chg(new_username)}\n        />\n        <TextInput\n          style={styles.text_box}\n          placeholder=\"Passowrd\"\n          defaultValue={password}\n          onChangeText={(new_password) => password_chg(new_password)}\n          secureTextEntry={true}\n        />\n        <TouchableOpacity\n          style={styles.Sign_in_btn}\n          onPress={() => login_submit(username, password)}\n        >\n          <Text style={styles.btn_label}>LOGIN</Text>\n        </TouchableOpacity>\n        <TouchableOpacity\n          style={styles.Sign_in_btn}\n          onPress={() => navigation.navigate(\"CreateAccount\")}\n        >\n          <Text style={styles.btn_label}>CREATE ACCOUNT</Text>\n        </TouchableOpacity>\n        <TouchableOpacity style={styles.forgot_btn}>\n          <Text style={styles.forgot_btn_label}>Forgot Passowrd</Text>\n        </TouchableOpacity>\n      </View>\n      <StatusBar style=\"auto\" />\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: \"#11b8f5\",\n    justifyContent: \"center\",\n    padding: 20,\n    display: \"flex\",\n  },\n  top_section: {\n    // backgroundColor: \"\",\n  },\n  bottom_section: {\n    backgroundColor: \"#fff\",\n    marginTop: 20,\n    padding: 10,\n    borderRadius: 10,\n  },\n  logo: {\n    marginLeft: \"auto\",\n    marginRight: \"auto\",\n    borderRadius: 50,\n  },\n  header: {\n    textAlign: \"center\",\n    fontSize: 25,\n    fontWeight: \"bold\",\n  },\n  msg: {\n    textAlign: \"center\",\n    fontSize: 17,\n  },\n  text_box: {\n    backgroundColor: \"#a7a7a7\",\n    color: \"#000\",\n    borderRadius: 10,\n    height: 45,\n    padding: 10,\n    margin: 10,\n    fontSize: 16,\n  },\n  Sign_in_btn: {\n    backgroundColor: \"#f00\",\n    height: 50,\n    width: 180,\n    margin: 3,\n    marginLeft: \"auto\",\n    marginRight: \"auto\",\n    borderRadius: 15,\n    display: \"flex\",\n    justifyContent: \"center\",\n    alignItems: \"center\",\n  },\n  btn_label: {\n    fontWeight: \"bold\",\n    fontSize: 15,\n    color: \"#fff\",\n  },\n  forgot_btn_label: {\n    fontWeight: \"100\",\n    fontSize: 15,\n    color: \"#59d3ff\",\n    textAlign: \"center\",\n  },\n});\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}